import os
import pandas as pd
folderpath = r"C:\ARRAYS" # make sure to put the 'r' in front
filepaths  = [os.path.join(folderpath, name) for name in os.listdir(folderpath)]
all_files = []

for path in filepaths:
    with open(path, 'r') as f:
        file = f.readlines()
        all_files.append(file)
        
# import xlwings as xw
# import pandas as pd
# filename = "C:\\Users\\Ayush\\Documents\\test.xlsx"
# df = pd.Series(all_files)
# wb = xw.Book(filename)
# ws = wb.sheets('Sheet1')
# ws.range('A2').options(index=False).value = df
# wb = xw.Book(filename)


# df.to_excel(r'C:\Users\Ayush\Documents\test1.xlsx', index = False)

 
#import xlsxwriter

#with xlsxwriter.Workbook('test.xlsx') as workbook:  #generate file test.xlsx
 #   worksheet = workbook.add_worksheet()

 #   for row_num, data in enumerate(all_files):
  #      worksheet.write_row(row_num, 0, data)
        
df = pd.DataFrame(all_files)
new_col = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
df['Malacious'] = new_col
# df



from sklearn.model_selection import train_test_split
X=df.iloc[:,:-1]
y = df.Malacious
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.40)
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
scaler.fit(X_train)
X_train = scaler.transform(X_train)
X_test = scaler.transform(X_test)

from sklearn.neighbors import KNeighborsClassifier
classifier = KNeighborsClassifier(n_neighbors=2)
classifier.fit(X_train, y_train)

y_pred = classifier.predict(X_test)

from sklearn.metrics import classification_report, confusion_matrix
print(classification_report(y_test, y_pred))
print(confusion_matrix(y_test, y_pred))